<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exceptions Report</title>
    <style>
    /* Global styles */
    :root {
        --primary-color: #3f51b5;
        --secondary-color: #5c6bc0;
        --success-color: #4caf50;
        --error-color: #f44336;
        --warning-color: #ff9800;
        --text-color: #333;
        --light-bg: #f5f7fa;
        --border-color: #e0e0e0;
        --header-bg: #f9f9f9;
        --card-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        --font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    }
    
    * {
        box-sizing: border-box;
    }
    
    body {
        font-family: var(--font-family);
        background-color: var(--light-bg);
        color: var(--text-color);
        line-height: 1.6;
        margin: 0;
        padding: 20px;
    }
    
    .container {
        max-width: 1200px;
        margin: 0 auto;
    }
    
    /* Base styles */
:root {
  --primary-color: #3f51b5;
  --secondary-color: #5c6bc0;
  --success-color: #4caf50;
  --error-color: #f44336;
  --warning-color: #ff9800;
  --text-color: #333;
  --light-bg: #f5f7fa;
  --border-color: #e0e0e0;
  --header-bg: #f9f9f9;
  --card-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  --font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
}

body {
  font-family: var(--font-family);
  line-height: 1.6;
  color: var(--text-color);
  background-color: var(--light-bg);
  margin: 0;
  padding: 20px;
}

/* Container */
.container {
  max-width: 1200px;
  margin: 0 auto;
}

/* Headings */
h1, h2, h3, h4, h5, h6 {
  color: var(--primary-color);
  margin-top: 1em;
  margin-bottom: 0.5em;
}

/* Question heading */
.question {
  font-size: 18px;
  font-weight: 600;
  margin-bottom: 15px;
  color: #333;
  background-color: #fef8e2;
  border: 1px solid #fbebbb;
  border-radius: 4px;
  padding: 12px;
}

/* Exception detail card */
.exception-detail {
  background-color: white;
  border-radius: 8px;
  margin-bottom: 20px;
  box-shadow: var(--card-shadow);
  overflow: hidden;
  border: 1px solid var(--border-color);
}

.exception-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px;
  background-color: rgba(244, 67, 54, 0.08);
  border-bottom: 1px solid rgba(244, 67, 54, 0.2);
  cursor: pointer;
  transition: background-color 0.2s;
}

.exception-header:hover {
  background-color: rgba(244, 67, 54, 0.12);
}

.exception-exception {
  font-weight: 600;
  color: var(--error-color);
}

.exception-content {
  padding: 0;
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.3s ease-out;
}

.exception-content.expanded {
  max-height: 5000px;
  padding: 20px;
  transition: max-height 0.5s ease-in;
}

/* Simple chevron indicator */
.chevron {
  display: inline-block;
  width: 20px;
  height: 20px;
  position: relative;
  margin-left: 8px;
}

.chevron::before {
  content: '';
  position: absolute;
  width: 8px;
  height: 8px;
  border-style: solid;
  border-width: 0 2px 2px 0;
  border-color: #666;
  transform: rotate(45deg);
  top: 4px;
  transition: transform 0.2s;
}

.exception-header[aria-expanded="true"] .chevron::before {
  transform: rotate(-135deg);
  top: 8px;
}

/* Section headers */
.section-header {
  border-bottom: 2px solid var(--primary-color);
  padding-bottom: 8px;
  margin: 24px 0 16px 0;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.section-header h3 {
  color: var(--primary-color);
  font-weight: 500;
  font-size: 18px;
  margin: 0;
}

.error-header {
  border-bottom-color: var(--error-color);
}

.error-header h3 {
  color: var(--error-color);
}

/* Details tables */
.details-table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 16px;
  table-layout: fixed;
}

.details-table th {
  width: 200px;
  text-align: left;
  padding: 12px;
  background-color: #f9f9f9;
  font-weight: 500;
  border-bottom: 1px solid var(--border-color);
  vertical-align: top;
}

.details-table td {
  padding: 12px;
  border-bottom: 1px solid var(--border-color);
  word-wrap: break-word;
  overflow-wrap: break-word;
}

.details-table tr:last-child th,
.details-table tr:last-child td {
  border-bottom: none;
}

.details-table tr:nth-child(even) {
  background-color: rgba(0, 0, 0, 0.02);
}

/* Code blocks */
pre {
  background-color: #f8f9fa;
  border: 1px solid var(--border-color);
  border-radius: 4px;
  padding: 12px;
  overflow: auto;
  max-height: 300px;
  font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
  font-size: 13px;
  white-space: pre-wrap;
  margin: 0;
  width: 100%;
}

.code-block {
  font-family: monospace;
  padding: 16px;
  background-color: #f8f9fa;
  border: 1px solid #ddd;
  border-radius: 4px;
  overflow-x: auto;
  max-height: 300px;
  margin-top: 0;
}

.traceback {
  font-style: italic;
  font-size: 13px;
}

/* Copy button */
.copy-button {
  background-color: var(--primary-color);
  color: white;
  border: none;
  padding: 6px 12px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
}

.copy-button:hover {
  background-color: #303f9f;
}

/* Responsive design */
@media (max-width: 768px) {
  .details-table {
    display: block;
    overflow-x: auto;
  }
  
  .details-table th {
    width: 140px;
  }
  
  .exception-header {
    padding: 12px;
  }
  
  .exception-content.expanded {
    padding: 15px;
  }
}
    </style>

    <script>
    // Toggle functionality for exception details
function toggleExceptionDetail(header) {
  const detail = header.closest('.exception-detail');
  const content = detail.querySelector('.exception-content');
  const expanded = header.getAttribute('aria-expanded') === 'true';
  
  if (expanded) {
    content.classList.remove('expanded');
    header.setAttribute('aria-expanded', 'false');
  } else {
    content.classList.add('expanded');
    header.setAttribute('aria-expanded', 'true');
  }
}

// Copy code functionality
function copyCode(button) {
  console.log("Copy button clicked");
  
  // Find the code block - look for pre/code elements after the button's parent
  const section = button.closest('div');
  const codeBlock = section.nextElementSibling;
  
  if (codeBlock) {
    // Get the text content
    let textToCopy = '';
    if (codeBlock.tagName === 'PRE') {
      textToCopy = codeBlock.textContent || '';
    } else if (codeBlock.tagName === 'TEXTAREA') {
      textToCopy = codeBlock.value || '';
    }
    
    // Use clipboard API if available, fallback to execCommand
    if (navigator.clipboard && navigator.clipboard.writeText) {
      navigator.clipboard.writeText(textToCopy)
        .then(() => {
          console.log("Text copied to clipboard successfully");
          showCopiedFeedback(button);
        })
        .catch(err => {
          console.error("Failed to copy text: ", err);
          fallbackCopy(textToCopy, button);
        });
    } else {
      fallbackCopy(textToCopy, button);
    }
  } else {
    console.error("Code block not found");
  }
}

// Fallback copy method using document.execCommand
function fallbackCopy(text, button) {
  // Create temporary textarea
  const textarea = document.createElement('textarea');
  textarea.value = text;
  textarea.style.position = 'fixed';  // Avoid scrolling to bottom
  document.body.appendChild(textarea);
  textarea.select();
  
  try {
    const successful = document.execCommand('copy');
    if (successful) {
      console.log("Fallback copy successful");
      showCopiedFeedback(button);
    } else {
      console.error("Fallback copy failed");
    }
  } catch (err) {
    console.error("Fallback copy error:", err);
  }
  
  document.body.removeChild(textarea);
}

// Show copied feedback on button
function showCopiedFeedback(button) {
  const originalText = button.textContent;
  button.textContent = 'Copied!';
  button.disabled = true;
  
  setTimeout(() => {
    button.textContent = originalText;
    button.disabled = false;
  }, 2000);
}

// Initialize all headers on page load
document.addEventListener('DOMContentLoaded', function() {
  console.log("DOM loaded, initializing exception toggles");
  
  // Set initial states for all exception contents
  const exceptionContents = document.querySelectorAll('.exception-content');
  console.log(`Found ${exceptionContents.length} exception contents`);
  
  exceptionContents.forEach(content => {
    content.classList.remove('expanded');
  });
  
  // Set aria attributes on headers and add click events
  const exceptionHeaders = document.querySelectorAll('.exception-header');
  console.log(`Found ${exceptionHeaders.length} exception headers`);
  
  exceptionHeaders.forEach(header => {
    header.setAttribute('aria-expanded', 'false');
    
    // Add click listener
    header.addEventListener('click', function(e) {
      console.log("Header clicked, toggling exception detail");
      toggleExceptionDetail(this);
    });
  });
  
  // Set up copy buttons
  const copyButtons = document.querySelectorAll('.copy-button');
  console.log(`Found ${copyButtons.length} copy buttons`);
  
  copyButtons.forEach(button => {
    // Add click listener
    button.addEventListener('click', function(e) {
      console.log("Copy button clicked");
      e.preventDefault();
      e.stopPropagation();
      copyCode(this);
    });
  });
});
    </script>

</head>
<body>
    <div class="container">
        <div class="summary-section">    
    <div class="table-container">
        <h2>Exceptions Report</h2>
        <table class="exceptions-table">
            <thead>
                <tr>
                    <th>Exception Type</th>
                    <th>Service</th>
                    <th>Model</th>
                    <th>Question Name</th>
                    <th class="count-column">Count</th>
                </tr>
            </thead>
            <tbody>
                
                    <tr>
                        <td>LanguageModelValueError</td>
                        <td>deep_infra</td>
                        <td>google/gemma-2-9b-it</td>
                        <td>dialogue</td>
                        <td class="count-cell">1</td>
                    </tr>
                
                    <tr>
                        <td>LanguageModelNoResponseError</td>
                        <td>deep_infra</td>
                        <td>google/gemma-2-9b-it</td>
                        <td>dialogue</td>
                        <td class="count-cell">1</td>
                    </tr>
                
            </tbody>
        </table>
    </div>
    
    <p class="note">
        Note: Each unique exception is counted only once. You may encounter repeated exceptions where retries were attempted.
    </p>
</div>

<style>
/* Summary section styles */
.summary-section {
    background-color: white;
    border-radius: 8px;
    margin-bottom: 24px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    border: 1px solid #e0e0e0;
    padding: 0 0 16px 0;
}

.section-header {
    background-color: #f9f9f9;
    padding: 12px 16px;
    border-bottom: 1px solid #e0e0e0;
}

.section-header h2 {
    margin: 0;
    font-size: 18px;
    font-weight: 500;
    color: #3f51b5;
}

.table-container {
    padding: 16px;
    overflow-x: auto;
}

/* Table styles */
.exceptions-table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 16px;
}

.exceptions-table th {
    background-color: #f5f5f5;
    color: #333;
    font-weight: 500;
    text-align: left;
    padding: 12px;
    border-bottom: 2px solid #e0e0e0;
}

.exceptions-table td {
    padding: 10px 12px;
    border-bottom: 1px solid #e0e0e0;
    color: #333;
}

.exceptions-table tr:hover {
    background-color: #f9f9f9;
}

.count-column {
    width: 80px;
    text-align: center;
}

.count-cell {
    text-align: center;
    font-weight: 500;
}

/* Note styles */
.note {
    font-size: 14px;
    color: #666;
    margin: 0 16px;
    line-height: 1.5;
}
</style>
        
    
        <div class="summary-section">
    <div class="section-header">
        <h2>Exception Details</h2>
    </div>
    <div class="p-4">
        <div class="question">Question name: dialogue</div>

        

        
            
            
            
                
                
                <div class="exception-detail">
                    <div class="exception-header">
                        <span class="exception-exception">
                            LanguageModelValueError
                        </span>
                        <span class="chevron"></span>
                    </div>
                    <div class="exception-content">
                        <!-- Error Summary Section -->
                        <div>
                            <div class="section-header error-header">
                                <h3>Error Summary</h3>
                            </div>
                            
                            <table class="details-table">
                                <tbody>
                                    <tr>
                                        <th>Exception</th>
                                        <td>LanguageModelValueError('No key found for service \'deep_infra\'\n\n\nException raised when there\'s an invalid value in a language model operation.\n    \n    This exception occurs when:\n    - A parameter value is out of its acceptable range\n    - A model configuration is invalid or incompatible\n    - An operation is attempted with improper settings\n    \n    To fix this error:\n    1. Check parameter values for validity (temperature, max_tokens, etc.)\n    2. Ensure model settings are compatible with the chosen provider\n    3. Verify that operation parameters are within acceptable ranges\n    \n    Examples:\n        ```python\n        # Setting temperature outside valid range\n        model = Model("gpt-4", temperature=2.5)  # Raises LanguageModelValueError\n        ```\n\n\nFor more information, see: https://docs.expectedparrot.com/en/latest/language_models.html')</td>
                                    </tr>
                                    <tr>
                                        <th>Model</th>
                                        <td>google/gemma-2-9b-it</td>
                                    </tr>
                                    <tr>
                                        <th>Question</th>
                                        <td>dialogue (free_text)</td>
                                    </tr>
                                    <tr>
                                        <th>Time</th>
                                        <td>2025-06-01T19:37:10.353582</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Details Section -->
                        <div>
                            <div class="section-header">
                                <h3>Details</h3>
                            </div>
                            <table class="details-table">
                                <tbody>
                                    <tr>
                                        <th>Interview ID</th>
                                        <td>0</td>
                                    </tr>
                                    <tr>
                                        <th>Question name</th>
                                        <td>dialogue</td>
                                    </tr>
                                    <tr>
                                        <th>Question type</th>
                                        <td>free_text</td>
                                    </tr>
                                    <tr>
                                        <th>User Prompt</th>
                                        <td><pre>You are S. Jaishankar, engaging in a negotiation with Wang Yi on the topic: "India-China Relations in backdop of Russia-Ukraine War".
Your goal is to propose a clear starting position, outline your priorities, and invite a collaborative resolution.
Avoid being combative; aim for mutual understanding an a potential deal.
Your output must be in a form of python dict:
{
    "Statement": "...",
    "grounding_sources": [
        {
            "title": "...",
            "type": "speech/article/News/Book/Quote",
            "url": "...",
            "quote": "...",
            "explanation": "Why it's relevant"
        }
    ]
}
Also the output should contain *ONLY* above format without any explanations.</pre></td>
                                    </tr>
                                    <tr>
                                        <th>Scenario</th>
                                        <td>None</td>
                                    </tr>
                                    <tr>
                                        <th>Agent</th>
                                        <td>None</td>
                                    </tr>
                                    <tr>
                                        <th>System Prompt</th>
                                        <td><pre>You are answering questions as if you were a human. Do not break character.Your traits: {'persona': "Pragmatic, analytical, and strategically-minded diplomat. Possesses a deep understanding of geopolitics, international relations, and India's historical role in the world. Exhibits a calm and measured demeanor, even under pressure.  Values realism and national interest above ideological considerations.  Can be perceived as somewhat reserved and direct, prioritizing substance over sentiment.", 'leadership': 'Strategic and results-oriented. Favors a consensus-building approach within the government but ultimately makes decisions based on careful analysis and national interest.  Empowers his team and expects high performance. Known for his meticulous preparation and attention to detail.  Promotes a data-driven approach to policy-making.', 'negotiation': "Calculated and patient.  Employs a long-term perspective, prioritizing sustainable outcomes over immediate gains. Skilled at identifying common ground and finding mutually beneficial solutions.  Willing to engage in tough conversations and stand firm on India's core interests.  Relies on detailed knowledge of the other party's position and motivations.", 'military_policy': "Advocates for a strong and self-reliant defense. Believes in modernizing India's military capabilities and fostering strategic partnerships to ensure regional stability and protect India's sovereignty.  Supports a balanced approach, combining indigenous defense production with selective imports.  Recognizes the importance of deterrence and a proactive defense posture.", 'economic_strategy': 'Supports a market-oriented economy with a focus on attracting foreign investment and promoting exports.  Advocates for trade liberalization and integration into the global economy, while also protecting domestic industries.  Emphasizes the importance of infrastructure development and technological innovation to drive economic growth.  Prioritizes energy security and diversification of energy sources.', 'communication_style': "Formal, precise, and articulate.  Favors a factual and data-driven approach in his public statements.  Avoids emotional language and focuses on conveying complex information clearly and concisely.  Often uses historical context and strategic frameworks to explain India's policies. Can be perceived as somewhat dry but always authoritative.", 'goal': "To enhance India's global standing and influence, safeguard its national interests, and contribute to a more stable and multipolar world order. To strengthen India's economic competitiveness and secure its place as a leading global power.", 'past_achievements': "Served as Foreign Secretary of India (2015-2018), playing a key role in shaping India's foreign policy during a period of significant geopolitical shifts. Ambassador to the United States (2013-2016), where he strengthened bilateral relations and expanded cooperation on a range of issues.  Played a crucial role in the Doklam standoff resolution.  Instrumental in shaping India's approach to the Indo-Pacific region and promoting the concept of the 'Indo-Pacific' as a strategic space."}</pre></td>
                                    </tr>
                                    <tr>
                                        <th>Inference service</th>
                                        <td>deep_infra</td>
                                    </tr>
                                    <tr>
                                        <th>Model name</th>
                                        <td>google/gemma-2-9b-it</td>
                                    </tr>
                                    <tr>
                                        <th>Model parameters</th>
                                        <td>Model(model_name = 'google/gemma-2-9b-it', service_name = 'deep_infra', temperature = 0.5, max_tokens = 1000, top_p = 1, frequency_penalty = 0, presence_penalty = 0, logprobs = False, top_logprobs = 3)</td>
                                    </tr>
                                    <tr>
                                        <th>Raw model response</th>
                                        <td><pre>No raw model response available.</pre></td>
                                    </tr>
                                    <tr>
                                        <th>Generated token string</th>
                                        <td><pre>No raw model response available.</pre></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Code to reproduce section -->
                        <div>
                            <div class="section-header code-header">
                                <h3>Code to reproduce error</h3>
                                <button class="copy-button">Copy</button>
                            </div>
                            <pre class="code-block"><code>from edsl import Question, Model, Scenario, Agent
q = Question('free_text', question_name = """dialogue""", question_text = """You are {{agent_name}}, engaging in a negotiation with {{other_agent_names}} on the topic: "{{topic}}".
Your goal is to propose a clear starting position, outline your priorities, and invite a collaborative resolution.
Avoid being combative; aim for mutual understanding an a potential deal.
Your output must be in a form of python dict:
{
    "Statement": "...",
    "grounding_sources": [
        {
            "title": "...",
            "type": "speech/article/News/Book/Quote",
            "url": "...",
            "quote": "...",
            "explanation": "Why it's relevant"
        }
    ]
}
Also the output should contain *ONLY* above format without any explanations.
""")
scenario = Scenario({'agent_name': 'S. Jaishankar', 'other_agent_names': 'Wang Yi', 'topic': 'India-China Relations in backdop of Russia-Ukraine War', 'conversation_index': None, 'index': 0, 'round_message': None})
agent = Agent(name = """S. Jaishankar""", traits = {'persona': "Pragmatic, analytical, and strategically-minded diplomat. Possesses a deep understanding of geopolitics, international relations, and India's historical role in the world. Exhibits a calm and measured demeanor, even under pressure.  Values realism and national interest above ideological considerations.  Can be perceived as somewhat reserved and direct, prioritizing substance over sentiment.", 'leadership': 'Strategic and results-oriented. Favors a consensus-building approach within the government but ultimately makes decisions based on careful analysis and national interest.  Empowers his team and expects high performance. Known for his meticulous preparation and attention to detail.  Promotes a data-driven approach to policy-making.', 'negotiation': "Calculated and patient.  Employs a long-term perspective, prioritizing sustainable outcomes over immediate gains. Skilled at identifying common ground and finding mutually beneficial solutions.  Willing to engage in tough conversations and stand firm on India's core interests.  Relies on detailed knowledge of the other party's position and motivations.", 'military_policy': "Advocates for a strong and self-reliant defense. Believes in modernizing India's military capabilities and fostering strategic partnerships to ensure regional stability and protect India's sovereignty.  Supports a balanced approach, combining indigenous defense production with selective imports.  Recognizes the importance of deterrence and a proactive defense posture.", 'economic_strategy': 'Supports a market-oriented economy with a focus on attracting foreign investment and promoting exports.  Advocates for trade liberalization and integration into the global economy, while also protecting domestic industries.  Emphasizes the importance of infrastructure development and technological innovation to drive economic growth.  Prioritizes energy security and diversification of energy sources.', 'communication_style': "Formal, precise, and articulate.  Favors a factual and data-driven approach in his public statements.  Avoids emotional language and focuses on conveying complex information clearly and concisely.  Often uses historical context and strategic frameworks to explain India's policies. Can be perceived as somewhat dry but always authoritative.", 'goal': "To enhance India's global standing and influence, safeguard its national interests, and contribute to a more stable and multipolar world order. To strengthen India's economic competitiveness and secure its place as a leading global power.", 'past_achievements': "Served as Foreign Secretary of India (2015-2018), playing a key role in shaping India's foreign policy during a period of significant geopolitical shifts. Ambassador to the United States (2013-2016), where he strengthened bilateral relations and expanded cooperation on a range of issues.  Played a crucial role in the Doklam standoff resolution.  Instrumental in shaping India's approach to the Indo-Pacific region and promoting the concept of the 'Indo-Pacific' as a strategic space."})
model = Model(model_name = 'google/gemma-2-9b-it', service_name = 'deep_infra', temperature = 0.5, max_tokens = 1000, top_p = 1, frequency_penalty = 0, presence_penalty = 0, logprobs = False, top_logprobs = 3)
results = q.by(model).by(agent).by(scenario).run()</code></pre>
                        </div>

                        <!-- Traceback section -->
                        <div>
                            <div class="section-header">
                                <h3>Traceback</h3>
                            </div>
                            <pre class="traceback">Traceback (most recent call last):
  File "/Users/sauravagarwal/llm-projects/MultiAgentFramework/.venv/lib/python3.9/site-packages/edsl/interviews/answering_function.py", line 307, in attempt_answer
    await invigilator.async_answer_question()
  File "/Users/sauravagarwal/llm-projects/MultiAgentFramework/.venv/lib/python3.9/site-packages/edsl/invigilators/invigilators.py", line 315, in async_answer_question
    agent_response_dict: AgentResponseDict = await self.async_get_agent_response()
  File "/Users/sauravagarwal/llm-projects/MultiAgentFramework/.venv/lib/python3.9/site-packages/edsl/invigilators/invigilators.py", line 302, in async_get_agent_response
    return await self.model.async_get_response(**params)
  File "/Users/sauravagarwal/llm-projects/MultiAgentFramework/.venv/lib/python3.9/site-packages/edsl/language_models/language_model.py", line 912, in async_get_response
    await self._async_get_intended_model_call_outcome(**params)
  File "/Users/sauravagarwal/llm-projects/MultiAgentFramework/.venv/lib/python3.9/site-packages/edsl/language_models/language_model.py", line 814, in _async_get_intended_model_call_outcome
    response = await asyncio.wait_for(f(**params), timeout=TIMEOUT)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/tasks.py", line 481, in wait_for
    return fut.result()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/futures.py", line 201, in result
    raise self._exception
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/tasks.py", line 256, in __step
    result = coro.send(None)
  File "/Users/sauravagarwal/llm-projects/MultiAgentFramework/.venv/lib/python3.9/site-packages/edsl/inference_services/services/open_ai_service.py", line 208, in async_execute_model_call
    client = self.async_client()
  File "/Users/sauravagarwal/llm-projects/MultiAgentFramework/.venv/lib/python3.9/site-packages/edsl/inference_services/services/open_ai_service.py", line 147, in async_client
    return cls.async_client(api_key=self.api_token)
  File "/Users/sauravagarwal/llm-projects/MultiAgentFramework/.venv/lib/python3.9/site-packages/edsl/language_models/language_model.py", line 364, in api_token
    raise LanguageModelValueError(
edsl.language_models.exceptions.LanguageModelValueError: No key found for service 'deep_infra'


Exception raised when there's an invalid value in a language model operation.
    
    This exception occurs when:
    - A parameter value is out of its acceptable range
    - A model configuration is invalid or incompatible
    - An operation is attempted with improper settings
    
    To fix this error:
    1. Check parameter values for validity (temperature, max_tokens, etc.)
    2. Ensure model settings are compatible with the chosen provider
    3. Verify that operation parameters are within acceptable ranges
    
    Examples:
        ```python
        # Setting temperature outside valid range
        model = Model("gpt-4", temperature=2.5)  # Raises LanguageModelValueError
        ```


For more information, see: https://docs.expectedparrot.com/en/latest/language_models.html
</pre>
                        </div>
                    </div>
                </div>
            
        
            
            
            
        
            
            
            
        
            
            
            
        
            
            
            
        
            
            
            
                
                
                <div class="exception-detail">
                    <div class="exception-header">
                        <span class="exception-exception">
                            LanguageModelNoResponseError
                        </span>
                        <span class="chevron"></span>
                    </div>
                    <div class="exception-content">
                        <!-- Error Summary Section -->
                        <div>
                            <div class="section-header error-header">
                                <h3>Error Summary</h3>
                            </div>
                            
                            <table class="details-table">
                                <tbody>
                                    <tr>
                                        <th>Exception</th>
                                        <td>LanguageModelNoResponseError('Language model did not return a response for question \'dialogue.\'\n\n\nException raised when a language model API fails to respond.\n    \n    This exception occurs when:\n    - The language model API cannot be reached (network error)\n    - The API request times out\n    - The service is unavailable or overloaded\n    - Authentication fails (in some cases)\n    \n    This exception is used in the retry mechanism for handling model API failures,\n    particularly during interviews and asynchronous operations.\n    \n    To fix this error:\n    1. Check your internet connection\n    2. Verify that the language model service is operational\n    3. Increase timeout settings if dealing with complex requests\n    4. Check API keys and authentication if applicable\n    5. Consider implementing exponential backoff retry logic\n    \n    Examples:\n        ```python\n        # API timeout during a model call\n        model.generate(prompt="Very complex prompt", timeout=1)  # Raises LanguageModelNoResponseError if timeout is too short\n        ```\n\n\nFor more information, see: https://docs.expectedparrot.com/en/latest/language_models.html#handling-errors')</td>
                                    </tr>
                                    <tr>
                                        <th>Model</th>
                                        <td>google/gemma-2-9b-it</td>
                                    </tr>
                                    <tr>
                                        <th>Question</th>
                                        <td>dialogue (free_text)</td>
                                    </tr>
                                    <tr>
                                        <th>Time</th>
                                        <td>2025-06-01T19:37:25.395185</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Details Section -->
                        <div>
                            <div class="section-header">
                                <h3>Details</h3>
                            </div>
                            <table class="details-table">
                                <tbody>
                                    <tr>
                                        <th>Interview ID</th>
                                        <td>0</td>
                                    </tr>
                                    <tr>
                                        <th>Question name</th>
                                        <td>dialogue</td>
                                    </tr>
                                    <tr>
                                        <th>Question type</th>
                                        <td>free_text</td>
                                    </tr>
                                    <tr>
                                        <th>User Prompt</th>
                                        <td><pre>You are S. Jaishankar, engaging in a negotiation with Wang Yi on the topic: "India-China Relations in backdop of Russia-Ukraine War".
Your goal is to propose a clear starting position, outline your priorities, and invite a collaborative resolution.
Avoid being combative; aim for mutual understanding an a potential deal.
Your output must be in a form of python dict:
{
    "Statement": "...",
    "grounding_sources": [
        {
            "title": "...",
            "type": "speech/article/News/Book/Quote",
            "url": "...",
            "quote": "...",
            "explanation": "Why it's relevant"
        }
    ]
}
Also the output should contain *ONLY* above format without any explanations.</pre></td>
                                    </tr>
                                    <tr>
                                        <th>Scenario</th>
                                        <td>None</td>
                                    </tr>
                                    <tr>
                                        <th>Agent</th>
                                        <td>None</td>
                                    </tr>
                                    <tr>
                                        <th>System Prompt</th>
                                        <td><pre>You are answering questions as if you were a human. Do not break character.Your traits: {'persona': "Pragmatic, analytical, and strategically-minded diplomat. Possesses a deep understanding of geopolitics, international relations, and India's historical role in the world. Exhibits a calm and measured demeanor, even under pressure.  Values realism and national interest above ideological considerations.  Can be perceived as somewhat reserved and direct, prioritizing substance over sentiment.", 'leadership': 'Strategic and results-oriented. Favors a consensus-building approach within the government but ultimately makes decisions based on careful analysis and national interest.  Empowers his team and expects high performance. Known for his meticulous preparation and attention to detail.  Promotes a data-driven approach to policy-making.', 'negotiation': "Calculated and patient.  Employs a long-term perspective, prioritizing sustainable outcomes over immediate gains. Skilled at identifying common ground and finding mutually beneficial solutions.  Willing to engage in tough conversations and stand firm on India's core interests.  Relies on detailed knowledge of the other party's position and motivations.", 'military_policy': "Advocates for a strong and self-reliant defense. Believes in modernizing India's military capabilities and fostering strategic partnerships to ensure regional stability and protect India's sovereignty.  Supports a balanced approach, combining indigenous defense production with selective imports.  Recognizes the importance of deterrence and a proactive defense posture.", 'economic_strategy': 'Supports a market-oriented economy with a focus on attracting foreign investment and promoting exports.  Advocates for trade liberalization and integration into the global economy, while also protecting domestic industries.  Emphasizes the importance of infrastructure development and technological innovation to drive economic growth.  Prioritizes energy security and diversification of energy sources.', 'communication_style': "Formal, precise, and articulate.  Favors a factual and data-driven approach in his public statements.  Avoids emotional language and focuses on conveying complex information clearly and concisely.  Often uses historical context and strategic frameworks to explain India's policies. Can be perceived as somewhat dry but always authoritative.", 'goal': "To enhance India's global standing and influence, safeguard its national interests, and contribute to a more stable and multipolar world order. To strengthen India's economic competitiveness and secure its place as a leading global power.", 'past_achievements': "Served as Foreign Secretary of India (2015-2018), playing a key role in shaping India's foreign policy during a period of significant geopolitical shifts. Ambassador to the United States (2013-2016), where he strengthened bilateral relations and expanded cooperation on a range of issues.  Played a crucial role in the Doklam standoff resolution.  Instrumental in shaping India's approach to the Indo-Pacific region and promoting the concept of the 'Indo-Pacific' as a strategic space."}</pre></td>
                                    </tr>
                                    <tr>
                                        <th>Inference service</th>
                                        <td>deep_infra</td>
                                    </tr>
                                    <tr>
                                        <th>Model name</th>
                                        <td>google/gemma-2-9b-it</td>
                                    </tr>
                                    <tr>
                                        <th>Model parameters</th>
                                        <td>Model(model_name = 'google/gemma-2-9b-it', service_name = 'deep_infra', temperature = 0.5, max_tokens = 1000, top_p = 1, frequency_penalty = 0, presence_penalty = 0, logprobs = False, top_logprobs = 3)</td>
                                    </tr>
                                    <tr>
                                        <th>Raw model response</th>
                                        <td><pre>No raw model response available.</pre></td>
                                    </tr>
                                    <tr>
                                        <th>Generated token string</th>
                                        <td><pre>No raw model response available.</pre></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Code to reproduce section -->
                        <div>
                            <div class="section-header code-header">
                                <h3>Code to reproduce error</h3>
                                <button class="copy-button">Copy</button>
                            </div>
                            <pre class="code-block"><code>from edsl import Question, Model, Scenario, Agent
q = Question('free_text', question_name = """dialogue""", question_text = """You are {{agent_name}}, engaging in a negotiation with {{other_agent_names}} on the topic: "{{topic}}".
Your goal is to propose a clear starting position, outline your priorities, and invite a collaborative resolution.
Avoid being combative; aim for mutual understanding an a potential deal.
Your output must be in a form of python dict:
{
    "Statement": "...",
    "grounding_sources": [
        {
            "title": "...",
            "type": "speech/article/News/Book/Quote",
            "url": "...",
            "quote": "...",
            "explanation": "Why it's relevant"
        }
    ]
}
Also the output should contain *ONLY* above format without any explanations.
""")
scenario = Scenario({'agent_name': 'S. Jaishankar', 'other_agent_names': 'Wang Yi', 'topic': 'India-China Relations in backdop of Russia-Ukraine War', 'conversation_index': None, 'index': 0, 'round_message': None})
agent = Agent(name = """S. Jaishankar""", traits = {'persona': "Pragmatic, analytical, and strategically-minded diplomat. Possesses a deep understanding of geopolitics, international relations, and India's historical role in the world. Exhibits a calm and measured demeanor, even under pressure.  Values realism and national interest above ideological considerations.  Can be perceived as somewhat reserved and direct, prioritizing substance over sentiment.", 'leadership': 'Strategic and results-oriented. Favors a consensus-building approach within the government but ultimately makes decisions based on careful analysis and national interest.  Empowers his team and expects high performance. Known for his meticulous preparation and attention to detail.  Promotes a data-driven approach to policy-making.', 'negotiation': "Calculated and patient.  Employs a long-term perspective, prioritizing sustainable outcomes over immediate gains. Skilled at identifying common ground and finding mutually beneficial solutions.  Willing to engage in tough conversations and stand firm on India's core interests.  Relies on detailed knowledge of the other party's position and motivations.", 'military_policy': "Advocates for a strong and self-reliant defense. Believes in modernizing India's military capabilities and fostering strategic partnerships to ensure regional stability and protect India's sovereignty.  Supports a balanced approach, combining indigenous defense production with selective imports.  Recognizes the importance of deterrence and a proactive defense posture.", 'economic_strategy': 'Supports a market-oriented economy with a focus on attracting foreign investment and promoting exports.  Advocates for trade liberalization and integration into the global economy, while also protecting domestic industries.  Emphasizes the importance of infrastructure development and technological innovation to drive economic growth.  Prioritizes energy security and diversification of energy sources.', 'communication_style': "Formal, precise, and articulate.  Favors a factual and data-driven approach in his public statements.  Avoids emotional language and focuses on conveying complex information clearly and concisely.  Often uses historical context and strategic frameworks to explain India's policies. Can be perceived as somewhat dry but always authoritative.", 'goal': "To enhance India's global standing and influence, safeguard its national interests, and contribute to a more stable and multipolar world order. To strengthen India's economic competitiveness and secure its place as a leading global power.", 'past_achievements': "Served as Foreign Secretary of India (2015-2018), playing a key role in shaping India's foreign policy during a period of significant geopolitical shifts. Ambassador to the United States (2013-2016), where he strengthened bilateral relations and expanded cooperation on a range of issues.  Played a crucial role in the Doklam standoff resolution.  Instrumental in shaping India's approach to the Indo-Pacific region and promoting the concept of the 'Indo-Pacific' as a strategic space."})
model = Model(model_name = 'google/gemma-2-9b-it', service_name = 'deep_infra', temperature = 0.5, max_tokens = 1000, top_p = 1, frequency_penalty = 0, presence_penalty = 0, logprobs = False, top_logprobs = 3)
results = q.by(model).by(agent).by(scenario).run()</code></pre>
                        </div>

                        <!-- Traceback section -->
                        <div>
                            <div class="section-header">
                                <h3>Traceback</h3>
                            </div>
                            <pre class="traceback">Traceback (most recent call last):
  File "/Users/sauravagarwal/llm-projects/MultiAgentFramework/.venv/lib/python3.9/site-packages/edsl/interviews/interview.py", line 516, in handle_task
    result: Answers = task.result()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/futures.py", line 201, in result
    raise self._exception
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/tasks.py", line 256, in __step
    result = coro.send(None)
  File "/Users/sauravagarwal/llm-projects/MultiAgentFramework/.venv/lib/python3.9/site-packages/edsl/tasks/question_task_creator.py", line 296, in _run_task_async
    return await self._run_focal_task()
  File "/Users/sauravagarwal/llm-projects/MultiAgentFramework/.venv/lib/python3.9/site-packages/edsl/tasks/question_task_creator.py", line 194, in _run_focal_task
    raise e
  File "/Users/sauravagarwal/llm-projects/MultiAgentFramework/.venv/lib/python3.9/site-packages/edsl/tasks/question_task_creator.py", line 188, in _run_focal_task
    results = await self.answer_question_func(
  File "/Users/sauravagarwal/llm-projects/MultiAgentFramework/.venv/lib/python3.9/site-packages/edsl/interviews/answering_function.py", line 359, in answer_question_and_record_task
    out = await attempt_answer()
  File "/Users/sauravagarwal/llm-projects/MultiAgentFramework/.venv/lib/python3.9/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
  File "/Users/sauravagarwal/llm-projects/MultiAgentFramework/.venv/lib/python3.9/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
  File "/Users/sauravagarwal/llm-projects/MultiAgentFramework/.venv/lib/python3.9/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
  File "/Users/sauravagarwal/llm-projects/MultiAgentFramework/.venv/lib/python3.9/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
  File "/Users/sauravagarwal/llm-projects/MultiAgentFramework/.venv/lib/python3.9/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
  File "/Users/sauravagarwal/llm-projects/MultiAgentFramework/.venv/lib/python3.9/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/concurrent/futures/_base.py", line 438, in result
    return self.__get_result()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/concurrent/futures/_base.py", line 390, in __get_result
    raise self._exception
  File "/Users/sauravagarwal/llm-projects/MultiAgentFramework/.venv/lib/python3.9/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
  File "/Users/sauravagarwal/llm-projects/MultiAgentFramework/.venv/lib/python3.9/site-packages/edsl/interviews/answering_function.py", line 343, in attempt_answer
    raise LanguageModelNoResponseError(
edsl.language_models.exceptions.LanguageModelNoResponseError: Language model did not return a response for question 'dialogue.'


Exception raised when a language model API fails to respond.
    
    This exception occurs when:
    - The language model API cannot be reached (network error)
    - The API request times out
    - The service is unavailable or overloaded
    - Authentication fails (in some cases)
    
    This exception is used in the retry mechanism for handling model API failures,
    particularly during interviews and asynchronous operations.
    
    To fix this error:
    1. Check your internet connection
    2. Verify that the language model service is operational
    3. Increase timeout settings if dealing with complex requests
    4. Check API keys and authentication if applicable
    5. Consider implementing exponential backoff retry logic
    
    Examples:
        ```python
        # API timeout during a model call
        model.generate(prompt="Very complex prompt", timeout=1)  # Raises LanguageModelNoResponseError if timeout is too short
        ```


For more information, see: https://docs.expectedparrot.com/en/latest/language_models.html#handling-errors
</pre>
                        </div>
                    </div>
                </div>
            
        
    </div>
</div>
    

    </div>
</body>
</html>